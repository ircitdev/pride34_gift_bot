# –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç - –û—Ç–ª–∞–¥–∫–∞ –±–æ—Ç–∞

## –ü—Ä–æ–±–ª–µ–º–∞
–ü–æ—Å–ª–µ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ñ–æ—Ç–æ –≤ –±–æ—Ç–∞ –Ω–∏—á–µ–≥–æ –Ω–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç.

## –†–µ—à–µ–Ω–∏–µ - 3 –ø—Ä–æ—Å—Ç—ã—Ö —à–∞–≥–∞

### üöÄ –®–∞–≥ 1: –û–±–Ω–æ–≤–∏—Ç—å –±–æ—Ç –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

**–î–≤–∞–∂–¥—ã –∫–ª–∏–∫–Ω–∏—Ç–µ –Ω–∞ —Ñ–∞–π–ª:**
```
deploy_to_server.bat
```

–≠—Ç–æ —Å–∫–æ–ø–∏—Ä—É–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –Ω–∞ —Å–µ—Ä–≤–µ—Ä –∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç –±–æ—Ç–∞.

> ‚ö†Ô∏è **–í–∞–∂–Ω–æ:** –ï—Å–ª–∏ —É –≤–∞—Å –¥—Ä—É–≥–æ–π —Å–µ—Ä–≤–µ—Ä, –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª `deploy_to_server.bat` –∏ —É–∫–∞–∂–∏—Ç–µ –≤–∞—à–∏ –¥–∞–Ω–Ω—ã–µ:
> - `SERVER_USER` - –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–æ–±—ã—á–Ω–æ `root`)
> - `SERVER_HOST` - IP –∞–¥—Ä–µ—Å —Å–µ—Ä–≤–µ—Ä–∞
> - `SERVER_PATH` - –ø—É—Ç—å –∫ –±–æ—Ç—É –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

---

### üì∏ –®–∞–≥ 2: –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Ñ–æ—Ç–æ –≤ –±–æ—Ç–∞

1. –û—Ç–∫—Ä–æ–π—Ç–µ –±–æ—Ç–∞ –≤ Telegram
2. –ù–∞—á–Ω–∏—Ç–µ –∫–≤–∏–∑ –∑–∞–Ω–æ–≤–æ –∫–æ–º–∞–Ω–¥–æ–π `/start`
3. –ü—Ä–æ–π–¥–∏—Ç–µ –∫–≤–∏–∑ –¥–æ –∫–æ–Ω—Ü–∞
4. –í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–ª
5. **–û—Ç–ø—Ä–∞–≤—å—Ç–µ —Ñ–æ—Ç–æ**

**–¢–µ–ø–µ—Ä—å –±–æ—Ç –¥–æ–ª–∂–µ–Ω –æ—Ç–≤–µ—Ç–∏—Ç—å:**
```
üîß DEBUG: –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∑–∞–ø—É—â–µ–Ω (state: QuizStates:waiting_for_photo)
```

–ï—Å–ª–∏ —ç—Ç–æ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ—è–≤–∏–ª–æ—Å—å - –∑–Ω–∞—á–∏—Ç –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç!

---

### üìã –®–∞–≥ 3: –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏

**–î–≤–∞–∂–¥—ã –∫–ª–∏–∫–Ω–∏—Ç–µ –Ω–∞ —Ñ–∞–π–ª:**
```
view_server_logs.bat
```

–≠—Ç–æ –ø–æ–∫–∞–∂–µ—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–µ 100 —Å—Ç—Ä–æ–∫ –ª–æ–≥–æ–≤ —Å —Å–µ—Ä–≤–µ—Ä–∞.

---

## –ß—Ç–æ –∏—Å–∫–∞—Ç—å –≤ –ª–æ–≥–∞—Ö

–ü–æ—Å–ª–µ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ñ–æ—Ç–æ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å —Ç–∞–∫–∞—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å:

```
üì∏ PHOTO HANDLER: Started for user 123456
üì∏ PHOTO HANDLER: Current state = QuizStates:waiting_for_photo
üì∏ PHOTO HANDLER: Got photo file_id: xxxxx
üì∏ PHOTO HANDLER: Downloading to user_photos/123456.jpg
üì∏ PHOTO HANDLER: Photo downloaded successfully
üîç PHOTO HANDLER: Starting face detection
üîç PHOTO HANDLER: Image loaded, shape: (height, width, 3)
üîç PHOTO HANDLER: Detected N face(s)
üíæ PHOTO HANDLER: Saving photo info to database
‚úÖ PHOTO HANDLER: Photo info saved to database
‚è≥ PHOTO HANDLER: Sending processing message
üé® PHOTO HANDLER: Starting image generation
‚úÖ PHOTO HANDLER: Image generated successfully
üì§ PHOTO HANDLER: Sending final result to user
‚úÖ SEND_FINAL_RESULT: Photo sent successfully
```

---

## –ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫

### 1Ô∏è‚É£ –ë–æ—Ç –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç "üîß DEBUG: –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∑–∞–ø—É—â–µ–Ω..."

**–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:**
- –ë–æ—Ç –Ω–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏–ª—Å—è –ø–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
- –í—ã –æ—Ç–ø—Ä–∞–≤–∏–ª–∏ —Ñ–∞–π–ª –≤–º–µ—Å—Ç–æ —Ñ–æ—Ç–æ (–æ—Ç–ø—Ä–∞–≤–ª—è–π—Ç–µ –∫–∞–∫ —Ñ–æ—Ç–æ!)
- –í—ã –Ω–µ –ø—Ä–æ—à–ª–∏ –∫–≤–∏–∑ –¥–æ –∫–æ–Ω—Ü–∞

**–†–µ—à–µ–Ω–∏–µ:**
- –ó–∞–ø—É—Å—Ç–∏—Ç–µ `deploy_to_server.bat` –µ—â–µ —Ä–∞–∑
- –ù–∞—á–Ω–∏—Ç–µ –∫–≤–∏–∑ –∑–∞–Ω–æ–≤–æ —Å `/start`
- –û—Ç–ø—Ä–∞–≤—å—Ç–µ –∏–º–µ–Ω–Ω–æ —Ñ–æ—Ç–æ (–Ω–µ "–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∫–∞–∫ —Ñ–∞–π–ª")

---

### 2Ô∏è‚É£ –ë–æ—Ç –æ—Ç–≤–µ—á–∞–µ—Ç, –Ω–æ –ø–æ—Ç–æ–º –∑–∞–≤–∏—Å–∞–µ—Ç

**–ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏** - –ø–æ—Å–ª–µ–¥–Ω—è—è —Å—Ç—Ä–æ–∫–∞ –ø–æ–∫–∞–∂–µ—Ç –≥–¥–µ –æ—Å—Ç–∞–Ω–æ–≤–∏–ª—Å—è –ø—Ä–æ—Ü–µ—Å—Å:

- –û—Å—Ç–∞–Ω–æ–≤–∏–ª—Å—è –Ω–∞ **"Starting face detection"** ‚Üí –ü—Ä–æ–±–ª–µ–º–∞ —Å OpenCV –∏–ª–∏ —Ñ–æ—Ç–æ
- –û—Å—Ç–∞–Ω–æ–≤–∏–ª—Å—è –Ω–∞ **"Starting image generation"** ‚Üí –ü—Ä–æ–±–ª–µ–º–∞ —Å —à–∞–±–ª–æ–Ω–∞–º–∏
- –û—Å—Ç–∞–Ω–æ–≤–∏–ª—Å—è –Ω–∞ **"Sending photo"** ‚Üí –§–∞–π–ª —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–π

---

### 3Ô∏è‚É£ –í –ª–æ–≥–∞—Ö –µ—Å—Ç—å –æ—à–∏–±–∫–∏ (‚ùå ERROR)

–ù–∞–π–¥–∏—Ç–µ —Å—Ç—Ä–æ–∫–∏ —Å –æ—à–∏–±–∫–∞–º–∏:
```bash
ssh root@31.44.7.144 "grep ERROR /var/www/pride34_gift_bot/logs/bot.log | tail -20"
```

---

## –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

### –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏:
```bash
ssh root@31.44.7.144 "tail -f /var/www/pride34_gift_bot/logs/bot.log"
```

### –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –±–æ—Ç–∞ –≤—Ä—É—á–Ω—É—é:
```bash
ssh root@31.44.7.144
cd /var/www/pride34_gift_bot
pkill -f "python.*main.py"
screen -dmS pride34_bot python main.py
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —á—Ç–æ –±–æ—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç:
```bash
ssh root@31.44.7.144 "ps aux | grep main.py"
```

---

## –ù—É–∂–Ω–∞ –ø–æ–º–æ—â—å?

–û—Ç–ø—Ä–∞–≤—å—Ç–µ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 50 —Å—Ç—Ä–æ–∫ –ª–æ–≥–æ–≤:
```bash
ssh root@31.44.7.144 "tail -50 /var/www/pride34_gift_bot/logs/bot.log"
```

–ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `view_server_logs.bat` –∏ —Å–∫–æ–ø–∏—Ä—É–π—Ç–µ –≤—ã–≤–æ–¥.
